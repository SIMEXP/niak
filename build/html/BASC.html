<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BASC pipeline &mdash; NIAK 1.1.4 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorials" href="TUTORIALS.html" />
    <link rel="prev" title="Connectome pipeline" href="CONNECTOME.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> NIAK
            <img src="_static/angelniak.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="INSTALLATION.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="PREPROCESSING.html">fMRI preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONNECTOME.html">Connectome pipeline</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">BASC pipeline</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#input-files">Input files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#preprocessed-fmri-data">Preprocessed fMRI data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#analysis-mask">Analysis mask</a></li>
<li class="toctree-l3"><a class="reference internal" href="#brain-areas">Brain areas</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#options">Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="#outputs">Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#publication-guidelines">Publication guidelines</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="TUTORIALS.html">Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NIAK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>BASC pipeline</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/BASC.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="basc-pipeline">
<h1>BASC pipeline<a class="headerlink" href="#basc-pipeline" title="Permalink to this headline"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h2>
<p>This tutorial describes how to apply a bootstrap analysis of stable clusters (BASC) on a group of fMRI datasets acquired on multiple subjects. The bootstrap analysis of stable clusters (BASC) is a pipeline that builds brain parcellations (clusters) based on the similarity of individual fMRI time series. The BASC implements some boostrap replications of the cluster analysis as well as a consensus clustering approach to capture stable clusters at the individual and group levels. The pipeline also includes an automated method (called MSTEPS) to identify critical numbers of clusters, that summarize accurately a whole hierarchy of decomposition into brain networks. There is a set of <a class="reference external" href="http://files.figshare.com/2030483/basc_pipeline_niak.pdf">slides</a> describing the pipeline.</p>
<p>The command to run the pipeline in a Matlab/Octave session is:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">niak_pipeline_stability_rest</span><span class="p">(</span><span class="n">files_in</span><span class="p">,</span><span class="n">opt</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>where ‘’files_in’’ is a structure describing how the dataset is organized, and ‘’opt’’ is a structure describing the options of the pipeline. The code of <a class="reference external" href="https://raw.githubusercontent.com/SIMEXP/niak/master/template/niak_template_stability_rest.m">niak_template_stability_rest</a> would be a good starting point to write your own script.</p>
</section>
<section id="input-files">
<h2>Input files<a class="headerlink" href="#input-files" title="Permalink to this headline"></a></h2>
<p>The inputs of the pipelines are:</p>
<ul class="simple">
<li><p>Preprocessed fMRI datasets.</p></li>
<li><p>A (3D) binary brain mask. The BASC will be applied only to the voxels within the mask.</p></li>
<li><p>A mask of brain areas. The region growing is applied on the concatenated time series of all subjects in each area to limit the memory demand.</p></li>
</ul>
<section id="preprocessed-fmri-data">
<h3>Preprocessed fMRI data<a class="headerlink" href="#preprocessed-fmri-data" title="Permalink to this headline"></a></h3>
<p>If the fMRI datasets have been preprocessed using NIAK, setting up the input files is very easy. Just grab the results of the preprocessing with the following command:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% The minimum number of volumes for an fMRI dataset to be included.</span><span class="w"></span>
<span class="c">% This option is useful when scrubbing is used, and the resulting time series may be too short.</span><span class="w"></span>
<span class="n">opt_g</span><span class="p">.</span><span class="n">min_nb_vol</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w"></span>
<span class="c">% Specify to the grabber to prepare the files for the region growing pipeline</span><span class="w"></span>
<span class="c">% opt_g.type_files = &#39;roi&#39;;</span><span class="w"></span>
<span class="n">files_in</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">niak_grab_fmri_preprocess</span><span class="p">(</span><span class="s">&#39;/home/pbellec/demo_niak_preproc/&#39;</span><span class="p">,</span><span class="n">opt_g</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>More options for the grabber are available. See ‘’help niak_grab_fmri_preprocess’’. If NIAK was not used to prepocess the data, all inputs have to be manually specified in the script. The first field ‘’fmri’’ directly lists all of the preprocessed fMRI datasets, organized by subject, session and runs. Example:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="n">files_in</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">subj1</span><span class="p">.</span><span class="n">sess1</span><span class="p">.</span><span class="n">rest</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;/data/fmri_subject1_session1_rest.nii.gz&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w"> </span><span class="n">files_in</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">subj2</span><span class="p">.</span><span class="n">sess1</span><span class="p">.</span><span class="n">rest</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;/data/fmri_subject2_session1_rest.nii.gz&#39;</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p><strong>WARNING</strong>: Octave and Matlab impose some restrictions on the labels used for subject, session and run. In order to avoid any issue, please do not use long labels (say less than 8 characters for subject, and ideally 4 characters or less for session/run). Also avoid to use any special character, including <code class="docutils literal notranslate"><span class="pre">.</span></code> <code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">-</span></code> or <code class="docutils literal notranslate"><span class="pre">_</span></code>. None of these restrictions apply on the naming convention of the files, just to the labels that are used to build the structure files_in in Matlab/Octave.</p>
</section>
<section id="analysis-mask">
<h3>Analysis mask<a class="headerlink" href="#analysis-mask" title="Permalink to this headline"></a></h3>
<p>The ‘’mask’’ field is the name of a 3D binary volume serving as a mask for the analysis. If the results of the fMRI preprocessing pipeline have been grabbed, the mask is automatically set to the the group mask generated in the quality control (i.e. voxels that fall in the brain for more than 50% of subjects). It can be a mask of the brain common to all subjects, or a mask of a specific brain area, e.g. the thalami. It is important to make sure that this segmentation is in the same space and resolution as the fMRI datasets. If not, use SPM/SPM or MINCRESAMPLE to resample the mask at the correct resolution.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="n">files_in</span><span class="p">.</span><span class="n">mask</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;/home/pbellec/demo_niak_preproc/quality_control/group_coregistration/func_mask_group_stereonl.nii.gz&#39;</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="brain-areas">
<h3>Brain areas<a class="headerlink" href="#brain-areas" title="Permalink to this headline"></a></h3>
<p>Finally, the ‘’areas’’ field is the name of a volume of integer values, describing some brain areas that are used to save memory space in the region-growing algorithm. By default, NIAK will use a modified AAL template that covers the full cerebellum, and is adapted to the MNI152 non-lilnear symmetric template. Different brain areas are treated independently at this step of the analysis. It is important to make sure that this segmentation is in the same space and resolution as the fMRI datasets. If not, use SPM or mincresample to resample the AAL segmentation at the correct resolution.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">files_in</span><span class="p">.</span><span class="n">areas</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;/data/roi_aal.nii.gz&#39;</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="options">
<h2>Options<a class="headerlink" href="#options" title="Permalink to this headline"></a></h2>
<p>The different options are passed through fields in the structure ‘’opt’’.</p>
<p>The first option is the name of the folder where the results will be stored. Note that this folder does not need to be created before hand. Example:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">opt</span><span class="p">.</span><span class="n">folder_out</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;/data/basc/&#39;</span><span class="p">;</span><span class="w"> </span><span class="c">% Where to store the results</span><span class="w"></span>
</pre></div>
</div>
<p>The second option is the size of the regions in the region growing algorithm, when they are mature (i.e. they stop growing). The parameter is set in mm3, if the size of voxels is specified in mm in the header (that is pretty much always the case). A threshold of 1000 mm3 will give about 1000 regions on the grey matter.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="p">.</span><span class="n">region_growing</span><span class="p">.</span><span class="n">thre_size</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1000</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>The following list will set the grid of scales (number of clusters) explored to identify stable clusters. The following grid will search from 10 to 500 clusters, with more granularity at low scales:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="p">.</span><span class="n">grid_scales</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">100</span><span class="w"> </span><span class="mi">120</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">200</span><span class="w"> </span><span class="mi">240</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">500</span><span class="p">]</span><span class="o">&#39;</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>The following scales will be used to generate the maps of brain clusters and stability. In this example the same number of clusters are used at the individual (first column), group (second column) and consensus (third and last colum) levels. It is also possible to leave this parameter empty, and then manually copy the results of the MSTEPS selection before restarting the pipeline.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="p">.</span><span class="n">scales_maps</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">repmat</span><span class="p">(</span><span class="n">opt</span><span class="p">.</span><span class="n">grid_scales</span><span class="p">,[</span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="p">]);</span><span class="w"></span>
</pre></div>
</div>
<p>The number of bootstrap samples at the individual level (100: the CI on indidividual stability is +/-0.1):</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="p">.</span><span class="n">stability_tseries</span><span class="p">.</span><span class="n">nb_samps</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>The number of bootstrap samples at the group level (500: the CI on group stability is +/-0.05):</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="p">.</span><span class="n">stability_group</span><span class="p">.</span><span class="n">nb_samps</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">500</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>The following flag turns on/off the generation of maps/time series at the individual level:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="p">.</span><span class="n">flag_ind</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>The following flag turns on/off the generation of maps/time series at the mixed level (group-level networks mixed with individual stability matrices):</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="p">.</span><span class="n">flag_mixed</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>The following flag turns on/off the generation of maps/time series at the group level:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">opt</span><span class="p">.</span><span class="n">flag_group</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="outputs">
<h2>Outputs<a class="headerlink" href="#outputs" title="Permalink to this headline"></a></h2>
<p>A number a subfolders are created in the ‘’opt.folder_out’’ directory. In the following, EXT will denote the extension associated with the file type of the functional images, e.g. ‘’.nii’’ or ‘’.nii.gz’’ for nifti. An exhaustive description of the outputs follows. Most of them may not be of interest. The main results have been highlighted with a 8-o. The results that are generated only if some scales are listed in the second pass are indicated by a <code class="docutils literal notranslate"><span class="pre">*</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">areas</span></code> subfolder contains the time series and mask of the areas used to perform region growing:</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">brain_areas.EXT</span></code></strong>: a 3D volume with integer values. The <code class="docutils literal notranslate"><span class="pre">I</span></code>th area is filled with <code class="docutils literal notranslate"><span class="pre">I</span></code>s.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">brain_areas_neig.mat</span></code></strong>: a .mat file which contains a bunch of variable. <code class="docutils literal notranslate"><span class="pre">ind_I</span></code> is a vector with the linear index of every voxels in brain area <code class="docutils literal notranslate"><span class="pre">I</span></code>. <code class="docutils literal notranslate"><span class="pre">neig_I</span></code> is a cell of vector. The <code class="docutils literal notranslate"><span class="pre">k</span></code>th entry is the list of the spatial neighbors of the voxel <code class="docutils literal notranslate"><span class="pre">k</span></code> in the <code class="docutils literal notranslate"><span class="pre">I</span></code> region. Note that all indices used here refer to entries in the list <code class="docutils literal notranslate"><span class="pre">ind_I</span></code>, which means that the <code class="docutils literal notranslate"><span class="pre">k</span></code>th entry correspond to the voxel <code class="docutils literal notranslate"><span class="pre">ind_I(k)</span></code>.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">part_areas_I.mat</span></code></strong>: a mat file with one vector <code class="docutils literal notranslate"><span class="pre">part</span></code>. <code class="docutils literal notranslate"><span class="pre">part(k)</span></code> is the number of the region voxel <code class="docutils literal notranslate"><span class="pre">k</span></code> of area <code class="docutils literal notranslate"><span class="pre">I</span></code> belongs to after region growing.</p></li>
</ul>
<p>The <strong><code class="docutils literal notranslate"><span class="pre">logs</span></code></strong> folder keeps track of all the execution of the pipeline (see below the section on pipeline management). This folder needs to be left intact at all time. It contains all the logs of the pipeline execution, but no results directly relevant to BASC.</p>
<p>The <strong><code class="docutils literal notranslate"><span class="pre">rois</span></code></strong> subfolder contains the ROIs generated through region-growing along with the associated time series for all runs and subjects:</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">brain_rois.EXT</span></code></strong>: a 3D volume with integer values. The <code class="docutils literal notranslate"><span class="pre">I</span></code>th ROI is filled with <code class="docutils literal notranslate"><span class="pre">I</span></code>s.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">tseries_&lt;subject&gt;_&lt;run&gt;.mat</span></code></strong>: a .mat file with one array <code class="docutils literal notranslate"><span class="pre">tseries</span></code>. The <code class="docutils literal notranslate"><span class="pre">I</span></code>th column of <code class="docutils literal notranslate"><span class="pre">tseries</span></code> is the time series associated with region <code class="docutils literal notranslate"><span class="pre">I</span></code> for subject <code class="docutils literal notranslate"><span class="pre">&lt;subject&gt;</span></code> and run <code class="docutils literal notranslate"><span class="pre">&lt;run&gt;</span></code></p></li>
</ul>
<p>The <strong><code class="docutils literal notranslate"><span class="pre">multiscale</span></code></strong> folder contains information about the exploration of stable clusters for different number of clusters.</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">silhouette.mat</span></code></strong>: a .mat file with the following variables :</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">scale_ind</span></code></strong>: vector, <code class="docutils literal notranslate"><span class="pre">scales_ind(k)</span></code> is the number of individual clusters for experiment <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">scale_group</span></code></strong>: vector, <code class="docutils literal notranslate"><span class="pre">scales_group(k)</span></code> is the number of group clusters for experiment <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">sil</span></code></strong>: array, <code class="docutils literal notranslate"><span class="pre">sil(m,k)</span></code> is the stability contrast criterion for <code class="docutils literal notranslate"><span class="pre">scale_ind(k)</span></code> clusters at the individual level, <code class="docutils literal notranslate"><span class="pre">scale_group(k)</span></code> clusters at the group level and <code class="docutils literal notranslate"><span class="pre">m</span></code> final clusters.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">sil_max</span></code></strong>: vector, <code class="docutils literal notranslate"><span class="pre">sil_max(m)</span></code> is the maximal stability contrast achieved for <code class="docutils literal notranslate"><span class="pre">m</span></code> final clusters, and the individual/group number of clusters in a neighbourhood of <code class="docutils literal notranslate"><span class="pre">m</span></code>.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">scales_ind_max</span></code></strong>: vector, <code class="docutils literal notranslate"><span class="pre">scales_ind_max(m)</span></code> is the number of individual clusters that achives <code class="docutils literal notranslate"><span class="pre">sil_max(m)</span></code> for <code class="docutils literal notranslate"><span class="pre">m</span></code> final clusters.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">scales_group_max</span></code></strong>: vector, <code class="docutils literal notranslate"><span class="pre">scales_group_max(m)</span></code> is the number of group clusters that achives <code class="docutils literal notranslate"><span class="pre">sil_max(m)</span></code> for <code class="docutils literal notranslate"><span class="pre">m</span></code> final clusters.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">table_multiscale.dat</span></code></strong>: a text file with a table. For all scales (meaning a set of individual, group and final number of clusters) investigated in the second pass, the table recapitulates the relative overlap of the clusters identified at different scales.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">figure_sigma_max.pdf</span></code></strong>: a pdf with the locally maximal stability contrast criterion as a function of the final number of clusters, along with the associated number of individual clusters and group clusters.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">table_sigma_max.dat</span></code></strong>: a text file recapitulating the local maxima of the stability contrast criterion, along with the corresponding number of clusters at the individual, group and final levels. These parameters can be used in the second pass analysis when re-running the pipeline.</p></li>
</ul>
<p>The folder <strong><code class="docutils literal notranslate"><span class="pre">stability_ind</span></code></strong> contains the results of BASC at the individual level. The subfolders <code class="docutils literal notranslate"><span class="pre">sci&lt;k&gt;</span></code> contains the results for <code class="docutils literal notranslate"><span class="pre">k</span></code> individual clusters:</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">stability_ind_&lt;subject&gt;_sci&lt;k&gt;_pass1.mat</span></code></strong>: a .mat file with a unique variable (vector) <code class="docutils literal notranslate"><span class="pre">stab</span></code>, which is the vectorized form of the individual stability matrix for subject <subject> and <k> individual clusters, for the first pass. Use <code class="docutils literal notranslate"><span class="pre">niak_vec2mat</span></code> to get the matrix form.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">stability_ind_&lt;subject&gt;_sci&lt;k&gt;_pass1.mat</span></code></strong>: a .mat file with a unique variable (vector) ‘’stab’’, which is the vectorized form of the individual stability matrix for subject &lt;subject&gt; and &lt;k&gt; individual clusters, for the second pass. Use ‘’niak_vec2mat’’ to get the matrix form.</p></li>
</ul>
<p>The folder <strong><code class="docutils literal notranslate"><span class="pre">stability_group</span></code></strong> contains the results of BASC at the group level. The subfolders <code class="docutils literal notranslate"><span class="pre">sci&lt;k&gt;_scg&lt;l&gt;</span></code> contains the results for <code class="docutils literal notranslate"><span class="pre">&lt;k&gt;</span></code> individual clusters and <code class="docutils literal notranslate"><span class="pre">&lt;l&gt;</span></code> group clusters:</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">brain_networks_sci&lt;k&gt;_scg&lt;l&gt;_scf&lt;m&gt;.EXT</span></code></strong>: a 3D map where the ‘’I’’th group stable cluster is filled with ‘’I’’s. A threshold is in addition applied on the regions of the cluster such as the average stability is greater than 0.5. This can change the total number of stable clusters.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">brain_partition_sci&lt;k&gt;_scg&lt;l&gt;_scf&lt;m&gt;.EXT</span></code></strong>: a 3D map where the ‘’I’’th group stable cluster is filled with ‘’I’’s.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">map_networks_group_sci&lt;k&gt;_scg&lt;l&gt;_scf&lt;m&gt;.EXT</span></code></strong>: a 3D map where the value in a region is the associated average group stability regarding the group stable network this region belongs to.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">map_networks_avg_ind_sci&lt;k&gt;_scg&lt;l&gt;_scf&lt;m&gt;.EXT</span></code></strong>: a 3D map where the value in a region is the associated average individual stability regarding the group stable network this region belongs to.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">map_networks_&amp;lt;subejct&amp;gt;_sci&lt;k&gt;_scg&lt;l&gt;_scf&lt;m&gt;.EXT</span></code></strong>: a 3D map where the value in a region is the associated individual stability for subject ‘’&lt;subject&gt;’’ regarding the group stable network this region belongs to.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">partition_networks_sci&lt;k&gt;_scg&lt;l&gt;_scf&lt;m&gt;.mat</span></code></strong>: a .mat files with the following variables :</p>
<ul>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">part</span></code></strong> (array) ‘’part(1,:)’’ is the partition of regions into stable group clusters. ‘’part(1,i)’’ is the number of the cluster associated with region ‘’i’’. ‘’part(2,:)’’ is the same, but after a threshold of 0.5 for the average group stability was applied on the regions.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">order</span></code></strong> (vector) is an ordering of the region deduced of the HAC on the group-level stability matrix. It is used to represent all stability matrices.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">hier</span></code></strong> (array) is a representation of the final HAC on the group-level stability matrix. See <code class="docutils literal notranslate"><span class="pre">niak_hierarchical</span> <span class="pre">clustering</span></code> for more infos.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">stability_group_sci&lt;k&gt;_scg&lt;l&gt;_pass1.mat</span></code></strong>: a .mat file with a number of variables:</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">stab_ind</span></code></strong> (vector) the vectorized form of the average individual stability matrix for <code class="docutils literal notranslate"><span class="pre">k</span></code> individual clusters and <code class="docutils literal notranslate"><span class="pre">l</span></code> group clusters, for the first pass. Use <code class="docutils literal notranslate"><span class="pre">niak_vec2mat</span></code> to get the matrix form.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">stab_group</span></code></strong> (vector) the vectorized form of the group stability matrix for <code class="docutils literal notranslate"><span class="pre">k</span></code> individual clusters and <code class="docutils literal notranslate"><span class="pre">l</span></code> group clusters, for the first pass. Use <code class="docutils literal notranslate"><span class="pre">niak_vec2mat</span></code> to get the matrix form.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">stab_plugin</span></code></strong> (vector) the vectorized form of the adjacency matrix resulting of HAC applied on the average individual stability matrix. It is the plugin estimate of the group adjacency matrix for &lt;k&gt; individual clusters and <code class="docutils literal notranslate"><span class="pre">l</span></code> group clusters, for the first pass. Use <code class="docutils literal notranslate"><span class="pre">niak_vec2mat</span></code> to get the matrix form.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">stability_group_sci&lt;k&gt;_&lt;t&gt;_pass2.mat</span></code></strong>: a .mat file with a number of variables:</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">stab_ind</span></code></strong> (vector) the vectorized form of the average individual stability matrix for <code class="docutils literal notranslate"><span class="pre">k</span></code> individual clusters and <code class="docutils literal notranslate"><span class="pre">l</span></code> group clusters, for the second pass. Use <code class="docutils literal notranslate"><span class="pre">niak_vec2mat</span></code> to get the matrix form.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">stab_group</span></code></strong> (vector) the vectorized form of the group stability matrix for <code class="docutils literal notranslate"><span class="pre">k</span></code> individual clusters and <code class="docutils literal notranslate"><span class="pre">l</span></code> group clusters, for the second pass. Use <code class="docutils literal notranslate"><span class="pre">niak_vec2mat</span></code> to get the matrix form.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">stab_plugin</span></code></strong> (vector) the vectorized form of the adjacency matrix resulting of HAC applied on the average individual stability matrix. It is the plugin estimate of the group adjacency matrix for <code class="docutils literal notranslate"><span class="pre">k</span></code> individual clusters and <code class="docutils literal notranslate"><span class="pre">l</span></code> group clusters, for the second pass. Use <code class="docutils literal notranslate"><span class="pre">niak_vec2mat</span></code> to get the matrix form.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">table_clusters_group_sci&lt;k&gt;_scg&lt;l&gt;_scf&lt;m&gt;.dat</span></code></strong>: a text file containing a table that recapitulates the local peaks of stability within each cluster.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">table_networks_group_sci&lt;k&gt;_scg&lt;l&gt;_scf&lt;m&gt;.dat</span></code></strong>: a text file containing a table that recapitulates the relative overlap of each cluster with Brodmann and AAL areas.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">tseries_networks_sci&lt;k&gt;_scg&lt;l&gt;_scf&lt;m&gt;_&lt;subject&gt;_&lt;run&gt;.mat</span></code></strong>: a .mat file with the following variables:</p>
<ul>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">tseries</span></code></strong>: the Ith column is the weighted average time series associated with cluster I, for <code class="docutils literal notranslate"><span class="pre">k</span></code> individual clusters, <code class="docutils literal notranslate"><span class="pre">l</span></code> group clusters, <code class="docutils literal notranslate"><span class="pre">m</span></code> final clusters. In the computation of the average, the contribution of each ROI to the mean is weighted by its stability.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">tseries_mean</span></code></strong>: the Ith column is the mean time series associated with cluster I, for <code class="docutils literal notranslate"><span class="pre">k</span></code> individual clusters, <code class="docutils literal notranslate"><span class="pre">l</span></code> group clusters, <code class="docutils literal notranslate"><span class="pre">m</span></code> final clusters.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">tseries_std</span></code></strong>: the Ith column is the standard deviation of the mean of the time series associated with cluster I, for <code class="docutils literal notranslate"><span class="pre">&lt;k&gt;</span></code> individual clusters, <code class="docutils literal notranslate"><span class="pre">&lt;l&gt;</span></code> group clusters, <code class="docutils literal notranslate"><span class="pre">&lt;m&gt;</span></code> final clusters.</p></li>
</ul>
</li>
</ul>
</section>
<section id="publication-guidelines">
<h2>Publication guidelines<a class="headerlink" href="#publication-guidelines" title="Permalink to this headline"></a></h2>
<p>Here is a short description of the BASC pipeline that can be adapted in a publication. You are encouraged to include the script that was used to run the pipeline as supplementary material of the article.</p>
<p>The fMRI data was first reduced to N time*space arrays using a region-growing algorithm, where N is the number of subjects and the spatial dimension is essentially selected by the user through a parameter which is the size of the regions when the region growing stops. Typically, a threshold of 1000 mm3 will result into around 1000 regions for a whole-brain analysis restricted to grey matter. The regions are built to maximize the average correlation between time series within each region for all subjects.</p>
<p>The basic principle of BASC is to repeat a clustering operation a large number of times, and compute the frequency at which each pair of regions fall in the same cluster. This stability matrix is then itself used in a clustering procedure, which derives so-called stable clusters (stable clusters are composed of regions with a high probability of falling in the same clusters, hence the name). That principle is first applied on individual fMRI time series, and replications of clustering are derived by applying a circular block bootstrap to fMRI time series. A stability matrix is derived for each subject. The average individual stability matrix is then computed and a hierarchical clustering is applied on it. This allows to define group-level clusters which maximize the average probability of being clustered at the individual level. By bootstrapping the subjects of the population, the group-level clustering itself can be subject to BASC, and a group-level stability matrix is derived. A hierarchical clustering is
finally applied on the group stability matrix to define stable group clusters. For each brain region, the average stability of that region with every other regions in the cluster of the seed can be derived. This can be done with the individual, average individual or group stability matrices, hence generating stability maps at all levels of analysis for every stable group cluster.</p>
<p>There are three main clustering parameters: the number of clusters at the individual, group and final levels (K, L and M respectively). The contrast of the group stability within and between stable group clusters is derived as a measure of the overall clustering quality. In a first pass, the space of all possible (K,L,M) is explored with a small number of bootstrap samples to save time. For each M, the maximal contrast for K and L in a neighbourhood of M is derived. It is then possible in a second pass to generate stability matrices with a high number of bootstrap samples for the number of clusters which are local maxima of the contrast.</p>
<p>Reference:</p>
<p>P. Bellec;P. Rosa-Neto; O. C. Lyttelton; H. Benali; A. Evans, Multi-level bootstrap analysis of stable clusters in resting-state fMRI. NeuroImage, Volume 51, Issue 3, 1 July 2010, Pages 1126-1139</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="CONNECTOME.html" class="btn btn-neutral float-left" title="Connectome pipeline" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="TUTORIALS.html" class="btn btn-neutral float-right" title="Tutorials" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, NIAK dev team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>